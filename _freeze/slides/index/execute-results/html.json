{
  "hash": "7c2a379c6bbd1b86f15f95fe7ecb1e56",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data Cleaning for Data Sharing<br> Using R\"\nauthor: \"Crystal Lewis // April 11, 2024<br>NCME Annual Meeting\"\nfooter: \"Data Cleaning for Data Sharing // [Cghlewis.github.io/ncme-data-cleaning-workshop/](https://Cghlewis.github.io/ncme-data-cleaning-workshop/)\"\nlogo: \"images/NCME-AnnualMeeting2024Logo-F.png\"\nformat: \n  revealjs: \n    width: 1600\n    height: 900  \n    theme: slides.scss\n    highlight-style: a11y\n    transition: fade\n    slide-number: true\nexecute:\n  echo: true\n---\n\n::: {.cell}\n\n:::\n\n## About the Speaker\n\n::: columns\n::: {.column width=\"50%\"}\n\n- Independent Research Data Management Consultant\n   - [cghlewis.com](https://cghlewis.com/)\n- Previously data manager for the Missouri Prevention Science Institute\n- Co-organizer for R-Ladies St. Louis\n  - [meetup.com/rladies-st-louis](https://www.meetup.com/rladies-st-louis/)\n- Co-organizer for the POWER Data Management in Education Research Hub\n  - [https://osf.io/ap3tk/](https://osf.io/ap3tk/)\n- Author \"Data Management in Large-Scale Education Research\"\n  - [datamgmtinedresearch.com](https://datamgmtinedresearch.com/)\n\n:::\n \n::: {.column width=\"50%\"}\n![](images/book-cover.jpg){fig-align=\"center\" width=60%}\n\n:::\n:::\n\n## Introductions\n\n::: columns\n::: {.column width=\"60%\"}\n\n- Your name\n- Your affiliation\n- Your role\n- Your data cleaning experience\n  - Original data that you/your team has collected\n  - External datasets\n- Your experience with R\n  - Tidyverse experience?\n\n:::\n \n::: {.column width=\"40%\"}\n![Image from [Unsplash](https://unsplash.com/photos/brown-and-black-short-coated-small-dog-with-white-long-coat-small-dog-on-gray-concrete-NIKl5WwL-RE)](images/greeting.jpg){fig-align=\"center\"}\n:::\n:::\n\n\n## 3 Phases of Data\n\n![](images/phases.jpg){fig-align=\"center\"}\n\n::: {.notes}\nRaw data may be original data that you collected\nIt may be externally collected data that you extracted from a site or received from a partner\nHere I just simply mean you have conducted no transformations on the data\n:::\n\n## A Sampling of Open Datasets\n\n::: {.r-stack}\n\n\n![](images/publicdata5.PNG){.fragment}\n\n\n![](images/publicdata2.PNG){.fragment}\n\n\n![](images/publicdata1-1.PNG){.fragment}\n\n\n![](images/publicdata6.PNG){.fragment}\n\n\n![](images/publicdata4.PNG){.fragment}\n\n\n:::\n\n::: {.notes}\nWhat do you notice when you look at these different datasets?\n\nThere is no real consistency in how data is structured, variables are named, o\n\nAdhering to common standards for data quality allows our data to be consistently cleaned and organized within and across projects. There are several data quality criteria that are commonly agreed upon \n:::\n\n## Learning Objectives\n\n::: incremental\n\n1.  Understand how to assess a data set for 7 data quality indicators\n\n<br>\n\n2.  Be able to review a data set and apply a list of standardized data cleaning steps as needed\n\n<br>\n\n3.  Feel comfortable using R code to clean a data set using our standardized steps\n\n<br>\n\n4.  Understand types of documentation that should be shared alongside data\n\n:::\n\n::: {.notes}\nBefore cleaning our data, we need to have a shared understanding for what we expect our data to look like once it is cleaned. \n:::\n\n\n## Schedule\n\n<br>\n\n\n| Time          | Topic           |\n|---------------|--------------------|\n|8:45 - 9:00  |   Intro/Logistics | \n|9:00 - 9:45 | Fundamentals of Data Organization|\n|9:45 - 10:30 | Standardized Data Cleaning Checklist|\n|10:30 - 10:45 | Break|\n|10:45 - 12:30 | Data Cleaning Functions|\n|12:30 - 12:45 | Documentation for Data Sharing|\n\n  \n## Logistics\n\n**Exercises**\n\nLogin to Posit Cloud workspace: [**https://posit.cloud/content/7872027**](https://posit.cloud/content/7872027).\n\n. . .\n\n<br>\n\nIf Posit Cloud doesn't work, download materials locally:\n\n::: {.cell}\n\n```{.r .cell-code}\nusethis::use_course(\n  \"https://github.com/jadeynryan/parameterized-quarto-workshop/raw/main/exercises/exercises.zip\"\n#  ,destdir = \"___\"\n  )\n```\n:::\n\n. . .\n\n<br>\n\nFeel free to interrupt me with questions/comments at any time âœ‹.\n\n. . .\n\n<br>\n\nGet up and move around as much as you need to ðŸš¶.\n  \n\n# Data Quality Indicators {.background-secondary}\n\n## The Data are Ready\n\n![](images/data-ready.PNG){fig-align=\"center\" width=\"80%\"}\n\n## 7 Data Quality Indicators\n\n::: columns\n::: {.column width=\"40%\"}\n\n<br>\n\n1. Analyzable\n\n2. Interpretable\n\n3. Complete\n\n4. Valid\n\n5. Accurate\n\n6. Consistent\n\n7. De-identified\n\n\n:::\n \n::: {.column width=\"60%\"}\n\n![Taming the Data Beast, by Allison Horst](images/data_beast_allison_horst.jpeg)\n\n:::\n:::\n\n## Analyzable\n\n- Data should make a rectangle of rows and columns\n  - The first row, and only the first row, is your variable names\n  - The remaining data should be made up of values in cells\n  - At least one column uniquely defines the rows in the data (e.g., unique identifier)\n\n![](images/quality-analyze1.PNG){fig-align=\"center\"}\n\n## Analyzable\n\n- Column values are analyzable\n  - Information is explicit\n  \n![](images/quality-analyze2.PNG){fig-align=\"center\" width=\"70%\"}\n\n## Analyzable\n\n<br>\n\n![](images/quality-analyze3.PNG){fig-align=\"center\"}\n\n## Analyzable\n\n- Only one piece of information is collected per variable\n\n![](images/quality-analyze4.PNG){fig-align=\"center\"}\n\n\n## [Exercise]{style=\"color:#ccd64d\"}{.background-secondary}\n\n<br>\n\nWhat data quality issues do you detect for the \"analyzable\" indicator?\n\n![](images/example-data.PNG){fig-align=\"center\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" id=\"timer_2dd06319\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;--countdown-font-size:2em;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">01</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::\n\n## [Solution]{style=\"color:#ccd64d\"}{.background-secondary}\n\n- Data does not make a rectangle\n- Color coding used to convey information\n- More than one piece of information in a variable\n- Blank values implied to be 0 for `Q4`{style=\"color:#ccd64d\"} variables\n\n\n![](images/quality-exercise1.PNG){fig-align=\"center\"}\n\n## Interpretable\n\n::: columns\n::: {.column width=\"50%\"}\n\n\n- Variable names should be machine-readable\n  - Unique\n  - No spaces or special characters except `_`\n    - This includes no `.` or `-`\n  - Not begin with a number\n\n- Variable names should be human-readable\n  - Meaningful (`gender` instead of `Q1`)\n  - Consistently formatted (capitalization and delimiters)\n  - Consistent order of information\n    - `w1_t_mast1`, `w1_t_mast2`, `w1_t_gad1`, `w1_t_gad2`, `w1_t_gender`\n\n:::\n \n::: {.column width=\"50%\"}\n\n![In that case, by Allison Horst](images/naming_case.jpg)\n\n:::\n:::\n\n## Interpretable\n\n- If you are sharing data in SPSS, SAS, or Stata format, you may consider adding embedded metadata (i.e., **variable label** and **value labels**)\n  - When publicly sharing data, it is recommended to share data in at least one non-proprietary format (e.g., CSV)\n  \n![](images/quality-interpret1.PNG){fig-align=\"center\"}\n\n## [Exercise]{style=\"color:#ccd64d\"}{.background-secondary}\n\n<br>\n\nWhat data quality issues do you detect for the \"interpretable\" indicator?\n\n![](images/example-data.PNG){fig-align=\"center\"}\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" id=\"timer_4984065e\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;--countdown-font-size:2em;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">01</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::\n\n## [Solution]{style=\"color:#ccd64d\"}{.background-secondary}\n\n- Spaces and special characters used in variable names\n- Some variable names are unclear\n- Inconsistent use of capitalization\n\n![](images/quality-exercise2.PNG){fig-align=\"center\"}\n\n## Complete\n\n- Cases\n  - The number of rows in your dataset should total to your sample N\n    - No missing cases\n    - No duplicate cases (i.e., no unique identifier)\n    \n- Variables\n  - The number of columns in your dataset should total to what you planned to have\n    - No missing variables\n  - No unexpected missing data\n    - If you collected the data, it should exist in the dataset\n\n## Helpful documentation\n\n#### Tracking Database\n\n![](images/quality-complete1.PNG){fig-align=\"center\"}\n\n#### Data Dictionary\n\n![](images/quality-complete2.PNG){fig-align=\"center\"}\n\n\n## [Exercise]{style=\"color:#ccd64d\"}{.background-secondary}\n\n<br>\n\nWhat data quality issues do you detect for the \"complete\" indicator?\n\n![](images/example-data.PNG){fig-align=\"center\"}\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" id=\"timer_8bc4e8ff\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;--countdown-font-size:2em;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">01</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::\n\n\n## [Solution]{style=\"color:#ccd64d\"}{.background-secondary}\n\n- The data contain a duplicate ID (104)\n\n![](images/quality-exercise3.PNG){fig-align=\"center\"}\n\n## Valid\n\n- Variables conform to your planned constraints (i.e., review your data dictionary)\n  - Planned variable types (e.g., `numeric`, `character`, `date`)\n  - Allowable variable values and ranges (e.g., `1-5`)\n  - Item-level missingness aligns with variable universe rules and skip patterns\n  \n![](images/quality-valid1.PNG){fig-align=\"center\"}\n\n\n## Helpful documentation\n\n![](images/quality-valid2.PNG){fig-align=\"center\"}\n\n## [Exercise]{style=\"color:#ccd64d\"}{.background-secondary}\n\n<br>\n\nWhat data quality issues do you detect for the \"valid\" indicator?\n\n![](images/example-data.PNG){fig-align=\"center\"}\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" id=\"timer_18916fa1\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;--countdown-font-size:2em;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">01</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::\n\n## [Solution]{style=\"color:#ccd64d\"}{.background-secondary}\n\n- `AGE/YR`{style=\"color:#ccd64d\"} does not adhere to our planned variable type\n- Values in `Score`{style=\"color:#ccd64d\"} fall out of our expected range\n\n![](images/quality-exercise4.PNG){fig-align=\"center\"}\n\n\n## Accurate\n\n- Information should be accurate based on any implicit knowledge you have\n  - For instance, values should not exist for a school where you know that data was not collected that wave\n\n- Accurate within and across sources\n  - A date of birth collected from school records should match the date of birth provided by the student\n  - If a student is in 2nd grade, they should be associated with a second grade teacher\n  \n## [Exercise]{style=\"color:#ccd64d\"}{.background-secondary}\n\n<br>\n\nWhat data quality issues do you detect for the \"accurate\" indicator?\n\n![](images/example-data.PNG){fig-align=\"center\"}\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" id=\"timer_6f9fe670\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;--countdown-font-size:2em;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">01</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::\n\n## [Solution]{style=\"color:#ccd64d\"}{.background-secondary}\n\n- ID 105 has conflicting information for `TEACHING LEVEL`{style=\"color:#ccd64d\"} and `SCHOOL`{style=\"color:#ccd64d\"}\n\n![](images/quality-exercise5.PNG){fig-align=\"center\"}\n\n## Consistent\n\n- Variable values are consistently measured, formatted, or categorized within a column\n\n- Variables are consistently measured across collections of the same form\n\n![](images/quality-consistent1.PNG){fig-align=\"center\"}\n\n\n## [Exercise]{style=\"color:#ccd64d\"}{.background-secondary}\n\n<br>\n\nWhat data quality issues do you detect for the \"consistent\" indicator?\n\n![](images/example-data.PNG){fig-align=\"center\"}\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" id=\"timer_ee605696\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;--countdown-font-size:2em;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">01</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::\n\n## [Solution]{style=\"color:#ccd64d\"}{.background-secondary}\n\n- Values for `GENDER`{style=\"color:#ccd64d\"} are not consistently categorized\n\n![](images/quality-exercise6.PNG){fig-align=\"center\"}\n\n## De-identified\n\n![](images/quality-identify1.PNG){fig-align=\"center\"}\n\n## De-identified - Indirect Identifiers\n\n- Open-ended questions\n  - These variables may contain information that can directly or indirectly identify individuals.\n- Outliers\n  - If someone has extreme values for a variable, it may be easier to identify that individual.\n- Small cell sizes\n  - [NCES Standard 4-2-10](https://nces.ed.gov/pubsearch/pubsinfo.asp?pubid=2003601), suggests that all categories have at least 3 cases to minimize risk\n- Combinations of variables, or crosstabs, can also create small cell-sizes\n  - race + gender + grade level\n- Also consider what other public information could be used to re-identify someone\n  - Linking department of education data with your data (e.g., by size and location of school)\n\n::: {.notes}\nYou also need to consider all of this in the context of risk. So if you are collecting information that is fairly innocuous (like maybe it's a math assessment), the risk of harm if your re-identified is pretty low. If you are collecting information like, how often do you use drugs, the risk is higher because that information could impact your career, relationships, and so forth. \n:::\n\n## [Exercise]{style=\"color:#ccd64d\"}{.background-secondary}\n\n<br>\n\nWhat data quality issues do you detect for the \"de-identified\" indicator?\n\n![](images/example-data.PNG){fig-align=\"center\"}\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" id=\"timer_75ef7f30\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;--countdown-font-size:2em;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">01</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::\n\n\n\n## [Solution]{style=\"color:#ccd64d\"}{.background-secondary}\n\n- Replace School Name with an unique ID\n- Review combination of demographics to see if other alterations are necessary\n\n![](images/quality-exercise7.PNG){fig-align=\"center\"}\n\n::: {.notes}\nThat one PhD may or may not be an issue. May there is only one person with a PhD in our sample, but many with PhDs in the school so maybe it's not a big deal. People (outside of that school) don't necessarily know who is in our sample and who is not.\n::: \n\n## Biggest Advice\n\nThe number one way to reduce data errors is to make a plan before you collect data\n\n> Correct data at the source\n\n<br>\n\n. . .\n\n- Plan the variables you want to collect\n\n. . .\n\n- Build your data collection/entry tools in a way that follows your plan\n\n. . .\n\n- Test your data tools before collecting/entering data\n\n. . .\n\n- Check your data often during data collection/entry\n\n\n\n# Data Cleaning Checklist {.background-secondary}\n\n## Data Cleaning\n\n![](images/side-by-side-data.PNG){fig-align=\"center\"}\n\n## Standard Data Cleaning Checklist\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 512 512\" style=\"height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/></svg>`{=html} Import the raw data\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 512 512\" style=\"height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/></svg>`{=html} Review the raw data\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 512 512\" style=\"height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/></svg>`{=html} Find missing data\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 512 512\" style=\"height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/></svg>`{=html} Adjust the sample\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 512 512\" style=\"height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/></svg>`{=html} De-identify data\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 512 512\" style=\"height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/></svg>`{=html} Drop irrelevant columns\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 512 512\" style=\"height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/></svg>`{=html} Split columns\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 512 512\" style=\"height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/></svg>`{=html} Rename variables\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 512 512\" style=\"height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/></svg>`{=html} Normalize variables\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 512 512\" style=\"height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/></svg>`{=html} Standardize variables\n\n:::\n \n::: {.column width=\"50%\"}\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 512 512\" style=\"height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/></svg>`{=html} Update variable types\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 512 512\" style=\"height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/></svg>`{=html} Recode variables\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 512 512\" style=\"height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/></svg>`{=html} Construct new variables\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 512 512\" style=\"height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/></svg>`{=html} Add missing values\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 512 512\" style=\"height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/></svg>`{=html} [Add metadata](https://github.com/Cghlewis/data-wrangling-functions/wiki/Label-Data)\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 512 512\" style=\"height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/></svg>`{=html} Validate data\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 512 512\" style=\"height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/></svg>`{=html} [Join data](https://cghlewis.com/blog/joins/)\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 512 512\" style=\"height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/></svg>`{=html} [Reshape data](https://osf.io/xumg4)\n\n`<svg aria-hidden=\"true\" role=\"img\" viewBox=\"0 0 512 512\" style=\"height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;\"><path d=\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\"/></svg>`{=html} Save clean data\n\n:::\n:::\n\n## Import raw data\n\n![](images/checklist1.PNG){fig-align=\"center\"}\n\n## Review data\n\n![](images/checklist2.PNG){fig-align=\"center\"}\n\n::: {.notes}\nAt this point you're just taking notes about what is going on in your data\nAm I even working with the right data\nWhat transformations are required based on what is going on in this data\n:::\n\n## Find missing data\n\n![](images/checklist3.PNG){fig-align=\"center\"}\n\n## Adjust the sample\n\n![](images/checklist4.PNG){fig-align=\"center\"}\n\n## De-identify data\n\n![](images/checklist5-1.PNG){fig-align=\"center\"}\n\n## De-identify data\n\n![](images/checklist5-2.PNG){fig-align=\"center\"}\n\n## De-identify data\n\n![](images/checklist5-3.PNG){fig-align=\"center\"}\n\n|Source|Resource|\n|--------|-----------|\n|[Alena Filip](https://www.sjsu.edu/research/docs/irb-data-management-handbook.pdf) |Table 2 provides pros and cons of various de-identification methods|\n|[J-PAL](https://www.povertyactionlab.org/resource/data-de-identification)| Table 3 provides a list of direct and indirect identifiers and recommended removal methods|\n|[Schatschneider, et.al](https://figshare.com/articles/preprint/De-Identification_Guide/13228664)| Deidentifying Data Guide|\n\n## Drop irrelevant columns\n\n<br>\n\n![](images/checklist6.PNG){fig-align=\"center\"}\n\n## Split columns\n\n![](images/checklist7.PNG){fig-align=\"center\"}\n\n## Rename variables\n\n![](images/checklist8.PNG){fig-align=\"center\"}\n\n## Normalize variables\n\n- Compare the types in your raw data to the types you expected in your data dictionary. Do they align?\n  - If not, what needs to be done so that they do\n\n![](images/checklist9.PNG){fig-align=\"center\"}\n\n## Standardize variables\n\n- Are columns consistently measured, coded, and formatted according to your data dictionary?\n\n![](images/checklist10.PNG){fig-align=\"center\"}\n\n## Update variable types\n\n![](images/checklist11.PNG){fig-align=\"center\"}\n\n## Recode variables\n\n![](images/checklist12.PNG){fig-align=\"center\"}\n\n## Construct additional variables\n\n![](images/checklist13.PNG){fig-align=\"center\"}\n\n## Add missing values\n\n![](images/checklist14.png){fig-align=\"center\"}\n\n## Data validation\n\n::: columns\n\n::: {.column width=\"50%\"}\n\n![](images/checklist15-1.PNG)\n\n:::\n\n::: {.column width=\"50%\"}\n\n::: {layout-nrow=2}\n\n![](images/checklist15-2.PNG)\n\n![](images/checklist15-3.PNG)\n\n:::\n\n:::\n:::\n\n## Data validation\n\n:::: {.columns}\n\n::: {.column width=\"60%\"}\n\n- Complete\n  - Check for missing/duplicate cases\n    - Check Ns by groups for completeness\n  - Correct for missing/too many columns\n- Valid and consistent\n  - Check for unallowed categories/values out of range\n    - Check ranges by groups\n  - Check for invalid, non-unique, or missing study IDs\n  - Check for incorrect variable types/formats\n  - Check missing value patterns\n\n:::\n \n::: {.column width=\"40%\"}\n\n- Accurate\n  - Agreement across variables\n- De-identified\n  - All direct identifiers are removed\n  - All indirect identifiers managed as needed\n- Interpretable\n  - Variables correctly named\n\n:::\n:::\n\n## Export data\n\n<br>\n\n![](images/checklist16.PNG){fig-align=\"center\"}\n\n## Creating a data cleaning plan\n\n![](images/data_cleaning_plan.PNG){fig-align=\"center\"}\n\n## BREAK!\n\n![](https://media1.tenor.com/m/XFNnJtXYH_gAAAAC/dog-wipe-face.gif){fig-align=\"center\" width=80%}\n\n## BREAK!\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" data-update-every=\"1\" id=\"timer_5c8cb638\" style=\"right:0;bottom:0;--countdown-font-size:10em; position: relative; width: min-content;\" tabindex=\"0\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">15</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::\n\n# Cleaning in R {.background-secondary}\n\n## Packages\n\n- R has many built in (base) functions\n- We can also use functions that live in packages that we can install onto our computer\n\n- Once installed, there are two ways to call packages\n  - You may see both methods used in these slides\n\n<br>\n\n::: columns\n::: {.column width=\"50%\"}\n\nUsing `library()`\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n\nmtcars |>  \n  select(mpg, cyl) \n```\n:::\n:::\n\n::: {.column width=\"50%\"}\n\nUsing Namespacing `package::function()`\n\n::: {.cell}\n\n```{.r .cell-code}\n# library(dplyr) not needed\n\nmtcars |>  \n  dplyr::select(mpg, cyl) \n```\n:::\n:::\n:::\n\n\n## Tidyverse\n\n<br>\n\nAn opinionated collection of R packages designed for data science\n\nAll packages share an underlying design philosophy, grammar, and data structures\n\n<br>\n\n::: {layout-nrow=4}\n\n![](images/dplyr.png)\n![](images/tidyr.png)\n![](images/stringr.png)\n![](images/readr.png)\n![](images/purrr.png)\n\n:::\n\n## Tidyverse\n\n<br>\n\nSelecting `test_score` and `grade_level` from our data frame named `sch_data`\n\n<br>\n\n::: columns\n::: {.column width=\"50%\"}\n\n[Tidy Evaluation](https://dplyr.tidyverse.org/articles/programming.html)\n\n<br>\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nselect(sch_data, test_score, \n       grade_level)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 2\n  test_score grade_level\n       <dbl>       <dbl>\n1        350           3\n2        380           4\n3        290           3\n```\n\n\n:::\n:::\n:::\n\n::: {.column width=\"50%\"}\n\nBase R\n\n<br>\n\n::: {.cell}\n\n```{.r .cell-code}\nsch_data[ , c(\"test_score\", \n              \"grade_level\")]\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 x 2\n  test_score grade_level\n       <dbl>       <dbl>\n1        350           3\n2        380           4\n3        290           3\n```\n\n\n:::\n:::\n:::\n:::\n\n## Pipes\n\n-   2014+ magrittr pipe `%>%`\n\n-   2021+ (R $\\geq$ 4.1.0) native R pipe `|>`\n\n. . .\n\nIsabella VelÃ¡squez's blog post [*Understanding the native R pipe* \\|\\>](https://ivelasq.rbind.io/blog/understanding-the-r-pipe/) (2022)\n\n<br>\n\n. . .\n\n::: columns\n::: {.column width=\"50%\"}\n::: {.cell}\n\n```{.r .cell-code}\nsch_data <- select(sch_data, id, \n                    test_score)\n\nsch_data <- filter(sch_data, \n                    test_score > 300)\n```\n:::\n:::\n\n::: {.column width=\"50%\"}\n::: {.cell}\n\n```{.r .cell-code}\nsch_data <- sch_data |>\n  select(id, test_score) |>\n  filter(test_score > 300)\n```\n:::\n:::\n:::\n\n. . .\n\n<br>\n\nTo turn on the native pipe:\n\n`Tools` â†’ `Global Options` â†’ `Code` â†’ `Editing` â†’ `Use Native Pipe Operator`\n\n## Open our data\n\n<br>\n\n:::: {.columns}\n\n::: {.column width=\"40%\"}\n\n<br>\n\n### Take 5 minutes to open and look at our data file.\n\n1. Log in to Posit Cloud and navigate to our project\n2. Open the data folder and open \"sample_tch_svy_raw.csv\"\n\n:::\n \n::: {.column width=\"60%\"}\n\n<br>\n\n![](images/sample-data.PNG){fig-align=\"center\"}\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" id=\"timer_0c18ee33\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;--countdown-font-size:2em;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">05</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::\n\n:::\n:::\n\n## Import our data\n\n<br>\n\nCommon data importing functions\n\n- `read_csv()` from the `readr` package\n\n- `read_excel()` from the `readxl` package\n\n- `read_sav()` from the `haven` package\n\n- Learn more about importing multiple files at once [here](https://github.com/Cghlewis/data-wrangling-functions/wiki/Import-Files)\n\n<br>\n\n. . .\n\n**Which function should we use to read in our sample data?**ðŸ¤”\n\n## Import our file\n\n::: columns\n \n::: {.column width=\"50%\"}\n\n- `read_excel()` has several arguments. \n  - path\n  - sheet = NULL\n  - col_names = TRUE\n  - na = \"\"\n  - skip = 0\n- Type `?read_excel()` in your console to see more arguments\n\n:::\n\n::: {.column width=\"50%\"}\n\n![](images/read_excel.PNG){fig-align=\"center\"}\n\n:::\n:::\n\n\n## [Exercise]{style=\"color:#ccd64d\"}{.background-secondary}\n\n<br>\n\n### Take 3 minutes to import the data.\n\n<br>\n\n1. Open \"exercises.Rmd\" in our Posit Cloud project.\n2. Navigate to exercise 1.\n3. Update the code and run the code chunk using the green arrow.\n4. If you get stuck, you can open \"solutions.Rmd\"\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" id=\"timer_73907bc7\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;--countdown-font-size:2em;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">03</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::\n\n## Review our data\n\n::: columns\n::: {.column width=\"50%\"}\n\n- How many rows?\n  - In this hypothetical situation, we assume we are not missing any cases\n  - However, there may be duplicates\n- How many columns?\n  - Compare to our data dictionary\n- What are the variable values and ranges?\n  - Compare to our data dictionary\n- How much missing data do we have?\n\n:::\n\n::: {.column width=\"50%\"}\n\nThere are several functions we can use to explore data\n\n- `dplyr::glimpse()`\n- `skimr::skim()`\n- `base::summary()`\n- `summarytools::dfSummary()`\n- `Hmisc::describe()`\n\n:::\n:::\n\n## [Exercise]{style=\"color:#ccd64d\"}{.background-secondary}\n\n<br>\n\n### Take 5 minutes to review our data.\n\n1. Navigate to exercise 2.\n2. Run the code. \n    - Write down any potential issues you see in the data.\n3. Open \"sample_tch_svy_data_dictionary.xlsx\". \n    - What issues do you see when you compare the data to our data dictionary?\n4. Review \"sample_tch_svy_cleaning-plan.txt\". \n    - How does it compare to the issues you wrote down?\n\n::: {.cell}\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"countdown\" id=\"timer_6f906a1e\" data-update-every=\"1\" tabindex=\"0\" style=\"right:0;bottom:0;--countdown-font-size:2em;\">\n<div class=\"countdown-controls\"><button class=\"countdown-bump-down\">&minus;</button><button class=\"countdown-bump-up\">&plus;</button></div>\n<code class=\"countdown-time\"><span class=\"countdown-digits minutes\">05</span><span class=\"countdown-digits colon\">:</span><span class=\"countdown-digits seconds\">00</span></code>\n</div>\n```\n\n:::\n:::\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/countdown-0.5.0/countdown.css\" rel=\"stylesheet\" />\n<script src=\"../site_libs/countdown-0.5.0/countdown.js\"></script>\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}